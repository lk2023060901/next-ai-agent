# æ¸ é“ç®¡ç†ç³»ç»Ÿ

## 1 æ¸ é“æ¦‚è¿°

### 1.1 æ”¯æŒçš„æ¸ é“åˆ—è¡¨

| æ¸ é“ | å›¾æ ‡ | åè®® | ä¼˜å…ˆçº§ | çŠ¶æ€ |
|------|------|------|--------|------|
| WebChat | ğŸ’¬ | WebSocket | P0 | å†…ç½® |
| Slack | Slack Logo | Bolt SDK | P0 | å†…ç½® |
| Discord | Discord Logo | discord.js | P0 | å†…ç½® |
| Telegram | Telegram Logo | grammY | P0 | å†…ç½® |
| é£ä¹¦ (Feishu) | é£ä¹¦ Logo | LarkSuite SDK | P1 | æ‰©å±• |
| é’‰é’‰ (DingTalk) | é’‰é’‰ Logo | DingTalk SDK | P1 | æ‰©å±• |
| ä¼ä¸šå¾®ä¿¡ (WeCom) | ä¼å¾® Logo | WeCom SDK | P1 | æ‰©å±• |
| WhatsApp | WhatsApp Logo | Baileys | P2 | æ‰©å±• |
| Signal | Signal Logo | signal-cli | P2 | æ‰©å±• |
| Microsoft Teams | Teams Logo | Bot Framework | P2 | æ‰©å±• |
| Email (IMAP/SMTP) | âœ‰ï¸ | IMAP/SMTP | P2 | æ‰©å±• |

### 1.2 æ¸ é“ç»Ÿä¸€æŠ½è±¡å±‚

æ‰€æœ‰æ¸ é“å®ç°ç»Ÿä¸€çš„æ¶ˆæ¯æ¥å£:

```typescript
interface ChannelMessage {
  id: string;
  channelType: ChannelType;
  channelAccountId: string;
  senderId: string;
  senderName: string;
  chatId: string;
  chatType: "dm" | "group" | "channel";
  content: MessageContent;
  attachments: Attachment[];
  replyToMessageId?: string;
  timestamp: Date;
}

interface MessageContent {
  text: string;
  markdown?: string;
  html?: string;
}

interface Attachment {
  type: "image" | "audio" | "video" | "file";
  url: string;
  mimeType: string;
  size: number;
  name: string;
  thumbnailUrl?: string;
}
```

---

## 2 æ¸ é“ç®¡ç†é¡µé¢

### 2.1 æ¸ é“åˆ—è¡¨é¡µ

**è·¯ç”±**: `/org/[slug]/ws/[workspace-slug]/channels`

**é¡µé¢å¤´éƒ¨**:
- æ ‡é¢˜: "æ¸ é“ç®¡ç†" (H2)
- æè¿°: "è¿æ¥æ¶ˆæ¯æ¸ é“ï¼Œè®© Agent æ¥æ”¶å’Œå‘é€æ¶ˆæ¯" (Body, Text-Secondary)
- "æ·»åŠ æ¸ é“" æŒ‰é’® (Primary, md)

**æ¸ é“åˆ—è¡¨** (å‚ç›´æ’åˆ—, é—´è· space-4):

æ¯ä¸ªæ¸ é“è¡Œ:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [æ¸ é“å›¾æ ‡ 40x40]  [space-3]                                       â”‚
â”‚                                                                   â”‚
â”‚ Slack                        [åœ¨çº¿ Badge Success]                 â”‚
â”‚ Workspace: My Team (Body-sm, Text-Secondary)                      â”‚
â”‚ å·²è¿æ¥ 3 ä¸ªé¢‘é“  Â·  æœ€è¿‘æ´»è·ƒ: 2åˆ†é’Ÿå‰ (Caption, Text-Tertiary)      â”‚
â”‚                                                                   â”‚
â”‚                              [é…ç½®](Ghost sm)  [æ–­å¼€](Danger Ghost sm) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- é«˜åº¦: auto (çº¦ 80px)
- å†…è¾¹è·: space-4
- èƒŒæ™¯: Surface
- åœ†è§’: radius-lg
- è¾¹æ¡†: 1px Border
- hover: border-color Primary-200

### 2.2 æ·»åŠ æ¸ é“æµç¨‹

**"æ·»åŠ æ¸ é“" â†’ Modal (lg: 800px)**

#### 2.2.1 æ­¥éª¤ 1: é€‰æ‹©æ¸ é“ç±»å‹

å¡ç‰‡ç½‘æ ¼ (3 åˆ—, é—´è· space-4):

æ¯ä¸ªæ¸ é“é€‰é¡¹å¡ç‰‡:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [æ¸ é“å›¾æ ‡ 48x48]        â”‚
â”‚  æ¸ é“åç§° (H4)           â”‚
â”‚  ç®€çŸ­æè¿° (Caption)      â”‚
â”‚  [çŠ¶æ€ Badge]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- å†…è¾¹è·: space-4
- åœ†è§’: radius-md
- hover: border Primary-200
- é€‰ä¸­: border 2px Primary-500, èƒŒæ™¯ Primary-50
- å·²è¿æ¥: å³ä¸Šè§’ CheckCircle (Success, 16px)
- å³å°†æ¨å‡º: ç°åº¦ + "Coming Soon" Badge

#### 2.2.2 æ­¥éª¤ 2: æ¸ é“é…ç½®

æ ¹æ®é€‰æ‹©çš„æ¸ é“ç±»å‹æ˜¾ç¤ºå¯¹åº”é…ç½®è¡¨å•ã€‚

**Slack é…ç½®**:
1. "åˆ›å»º Slack App" è¯´æ˜ (å¸¦å¤–é“¾æŒ‰é’®)
2. Bot Token è¾“å…¥æ¡† (Label: "Bot Token", Placeholder "xoxb-...")
3. App Token è¾“å…¥æ¡† (Label: "App Token", Placeholder "xapp-...")
4. Signing Secret è¾“å…¥æ¡† (type=password)
5. "æµ‹è¯•è¿æ¥" æŒ‰é’® (Secondary)
   - æµ‹è¯•ä¸­: Loading çŠ¶æ€
   - æˆåŠŸ: âœ“ "è¿æ¥æˆåŠŸ" (Success æ–‡å­—) + æ˜¾ç¤º Bot åç§°
   - å¤±è´¥: âœ— "è¿æ¥å¤±è´¥: Token æ— æ•ˆ" (Danger æ–‡å­—)

**Discord é…ç½®**:
1. Bot Token è¾“å…¥æ¡†
2. Application ID è¾“å…¥æ¡†
3. "æµ‹è¯•è¿æ¥" æŒ‰é’®

**Telegram é…ç½®**:
1. Bot Token è¾“å…¥æ¡† (Placeholder "123456:ABC-DEF...")
2. Webhook URL (è‡ªåŠ¨ç”Ÿæˆ, åªè¯», å¸¦å¤åˆ¶æŒ‰é’®)
3. "æµ‹è¯•è¿æ¥" æŒ‰é’®

**é£ä¹¦é…ç½®**:
1. App ID è¾“å…¥æ¡†
2. App Secret è¾“å…¥æ¡†
3. Verification Token è¾“å…¥æ¡†
4. "æµ‹è¯•è¿æ¥" æŒ‰é’®

#### 2.2.3 æ­¥éª¤ 3: è·¯ç”±è®¾ç½®

- **é»˜è®¤ Agent**: Select (å·¥ä½œåŒºå†… Agent åˆ—è¡¨)
- **DM ç­–ç•¥**: Radio Group
  - "é…å¯¹æ¨¡å¼" â€” æœªçŸ¥å‘é€è€…éœ€è¾“å…¥é…å¯¹ç  (æ¨è)
  - "å¼€æ”¾æ¨¡å¼" â€” æ‰€æœ‰äººå¯å‘æ¶ˆæ¯
  - "ä»…å…è®¸åˆ—è¡¨" â€” ä»…å…è®¸æŒ‡å®šç”¨æˆ·
- **ç¾¤ç»„ç­–ç•¥**: Radio Group
  - "æåŠè§¦å‘" â€” ä»… @bot æ—¶å“åº”
  - "å§‹ç»ˆå“åº”" â€” æ‰€æœ‰æ¶ˆæ¯éƒ½å“åº”
  - "å…³é”®è¯è§¦å‘" â€” åŒ…å«æŒ‡å®šå…³é”®è¯æ—¶å“åº”

#### 2.2.4 æ­¥éª¤æŒ‡ç¤ºå™¨

Modal é¡¶éƒ¨:
```
  â‘  é€‰æ‹©æ¸ é“   â€”â€”   â‘¡ é…ç½®è¿æ¥   â€”â€”   â‘¢ è·¯ç”±è®¾ç½®
  [â—]          [â—‹]          [â—‹]
```

- å½“å‰æ­¥éª¤: Primary-500, font-weight 600
- å·²å®Œæˆæ­¥éª¤: Success, Check å›¾æ ‡
- æœªåˆ°æ­¥éª¤: Text-Tertiary
- è¿æ¥çº¿: 2px, Border / Primary-500 (å·²é€šè¿‡)

### 2.3 æ¸ é“è¯¦æƒ…é¡µ

**è·¯ç”±**: `/org/[slug]/ws/[workspace-slug]/channels/[channel-id]`

**Tabs**: æ¦‚è§ˆ | æ¶ˆæ¯æ—¥å¿— | è·¯ç”±è§„åˆ™ | è®¾ç½®

#### 2.3.1 æ¦‚è§ˆ Tab

2x2 ç»Ÿè®¡å¡ç‰‡:
- ä»Šæ—¥æ¶ˆæ¯æ•° (Inbound + Outbound åˆ†åˆ«æ ‡æ³¨)
- å“åº”æ—¶é—´ (å¹³å‡, ms)
- æ´»è·ƒç”¨æˆ·æ•°
- å¤±è´¥æ¶ˆæ¯æ•°

ä¸‹æ–¹: 24h æ¶ˆæ¯é‡æŠ˜çº¿å›¾ (é«˜åº¦ 200px)
- X è½´: æ—¶é—´ (0:00 - 23:00)
- Y è½´: æ¶ˆæ¯æ•°
- ä¸¤æ¡çº¿: Inbound (Primary), Outbound (Success)
- å›¾ä¾‹: å³ä¸Šè§’

#### 2.3.2 æ¶ˆæ¯æ—¥å¿— Tab

**ç­›é€‰å™¨**:
- æ—¶é—´èŒƒå›´: DateRangePicker
- æ–¹å‘: Select (å…¨éƒ¨/å…¥ç«™/å‡ºç«™)
- å‘é€è€…: Input (æœç´¢)
- çŠ¶æ€: Select (å…¨éƒ¨/æˆåŠŸ/å¤±è´¥)

**æ¶ˆæ¯åˆ—è¡¨** (è¡¨æ ¼):

| åˆ— | å®½åº¦ | å†…å®¹ |
|-----|------|------|
| æ—¶é—´ | 15% | Caption, ç²¾ç¡®åˆ°ç§’ |
| æ–¹å‘ | 5% | â†— (å‡ºç«™, Primary) / â†™ (å…¥ç«™, Success) |
| å‘é€è€… | 15% | åç§° |
| å†…å®¹ | 40% | Body-sm, 1è¡Œæˆªæ–­ |
| Agent | 15% | è§’è‰²è‰² Badge + Agent å |
| çŠ¶æ€ | 10% | âœ“ æˆåŠŸ / âœ— å¤±è´¥ (å¸¦ tooltip é”™è¯¯è¯¦æƒ…) |

- ç‚¹å‡»è¡Œ: å±•å¼€æ¶ˆæ¯è¯¦æƒ… (å®Œæ•´å†…å®¹ + é™„ä»¶é¢„è§ˆ + å¤„ç†è€—æ—¶)
- åˆ†é¡µ: æ¯é¡µ 50 æ¡

#### 2.3.3 è·¯ç”±è§„åˆ™ Tab

è·¯ç”±è§„åˆ™åˆ—è¡¨ (æ‹–æ‹½æ’åº):
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â‰¡ (æ‹–æ‹½æ‰‹æŸ„)                                              â”‚
â”‚ è§„åˆ™ 1: å½“ [å‘é€è€…] [åŒ…å«] [@admin]                       â”‚
â”‚         åˆ™ [è·¯ç”±åˆ°] [åè°ƒ Agent]                           â”‚
â”‚ [ç¼–è¾‘] [åˆ é™¤]                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â‰¡                                                        â”‚
â”‚ è§„åˆ™ 2: å½“ [å†…å®¹] [åŒ…å«] [/bug]                           â”‚
â”‚         åˆ™ [è·¯ç”±åˆ°] [æµ‹è¯• Agent]                           â”‚
â”‚ [ç¼–è¾‘] [åˆ é™¤]                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é»˜è®¤: è·¯ç”±åˆ° [åè°ƒ Agent]                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ·»åŠ è§„åˆ™ Modal**:
- æ¡ä»¶: [å­—æ®µ Select] [æ“ä½œç¬¦ Select] [å€¼ Input]
  - å­—æ®µ: å‘é€è€… / å†…å®¹ / ç¾¤ç»„ / æ¸ é“
  - æ“ä½œç¬¦: ç­‰äº / åŒ…å« / æ­£åˆ™åŒ¹é… / å±äºåˆ—è¡¨
- åŠ¨ä½œ: [è·¯ç”±åˆ° Agent Select]
- ä¼˜å…ˆçº§: æ•°å­— (è¶Šå°è¶Šä¼˜å…ˆ)

---

## 3 WebChat å†…ç½®æ¸ é“

### 3.1 WebChat ç•Œé¢

**åµŒå…¥æ–¹å¼**: iframe æˆ– Web Component

**å°ºå¯¸**:
- æµ®åŠ¨çª—å£: 400px å®½ x 600px é«˜
- å…¨å±æ¨¡å¼: 100% x 100%
- åµŒå…¥æ¨¡å¼: çˆ¶å®¹å™¨è‡ªé€‚åº”

**æµ®åŠ¨æŒ‰é’®**:
- ä½ç½®: å³ä¸‹è§’, è·è¾¹ space-5
- å¤§å°: 56x56px
- èƒŒæ™¯: Primary-500
- å›¾æ ‡: MessageCircle (24px, #FFFFFF)
- åœ†è§’: radius-full
- é˜´å½±: shadow-lg
- hover: scale(1.05)
- æœªè¯»æ¶ˆæ¯: å³ä¸Šè§’çº¢è‰²æ•°å­— Badge

**èŠå¤©çª—å£**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Agentå¤´åƒ] [Agentå] [åœ¨çº¿â—]    [â€”] [Ã—] â”‚  â† å¤´éƒ¨ 48px
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚  æ¶ˆæ¯åŒºåŸŸ (å¯æ»šåŠ¨)                         â”‚
â”‚  (æ ·å¼åŒä¸»èŠå¤©ç•Œé¢, ç®€åŒ–ç‰ˆ)                 â”‚
â”‚                                          â”‚
â”‚                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ğŸ“] [è¾“å…¥æ¡† ___________________] [â¤]    â”‚  â† è¾“å…¥åŒº 56px
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- å¤´éƒ¨èƒŒæ™¯: Primary-500
- å¤´éƒ¨æ–‡å­—: #FFFFFF
- å…³é—­/æœ€å°åŒ–æŒ‰é’®: rgba(255,255,255,0.7), hover #FFFFFF
- è¾“å…¥åŒºè¾¹æ¡†: é¡¶éƒ¨ 1px Border
- å“ç‰Œæ°´å°: åº•éƒ¨å±…ä¸­ "Powered by NextAI Agent" (Tiny, Text-Tertiary)

### 3.2 WebChat åµŒå…¥ä»£ç 

åœ¨æ¸ é“è®¾ç½®é¡µé¢æä¾›:
```html
<!-- å¤åˆ¶ä»£ç å—, å³ä¸Šè§’å¤åˆ¶æŒ‰é’® -->
<script src="https://app.nextai-agent.com/webchat.js"></script>
<script>
  NextAIChat.init({
    workspaceId: "ws_xxx",
    agentId: "agent_xxx",
    theme: "light",
    position: "bottom-right",
    greeting: "ä½ å¥½ï¼æœ‰ä»€ä¹ˆå¯ä»¥å¸®ä½ çš„ï¼Ÿ"
  });
</script>
```

- ä»£ç å—: æ·±è‰²èƒŒæ™¯, Code å­—ä½“, è¯­æ³•é«˜äº®
- é…ç½®é¡¹è¡¨å•: ä¸ä»£ç å—è”åŠ¨, ä¿®æ”¹è¡¨å•è‡ªåŠ¨æ›´æ–°ä»£ç 
