# NextAI Agent — SaaS 多智能体平台产品需求文档

## 1 产品概述

### 1.1 产品定位

NextAI Agent 是一个企业级 SaaS 多智能体协作平台，基于 OpenClaw 个人 AI 助手的核心能力进行改造升级。平台支持用户通过自然语言提出需求，由多智能体系统自动完善需求、拆解任务、分派执行、审查交付，覆盖从产品需求到代码发布的全生命周期。

### 1.2 核心价值

| 维度 | 描述 |
|------|------|
| 多智能体协作 | 支持 Anthropic Agent Teams 概念，多 Agent 并行/串行协作 |
| 全渠道接入 | WhatsApp、Telegram、Slack、Discord、微信、钉钉、飞书、WebChat |
| 端到端自动化 | 需求 → 设计 → 开发 → 测试 → 部署 → 审查 |
| SaaS 多租户 | 支持团队/组织隔离，按量计费 |
| 可扩展插件 | 插件市场 + 自定义 Skill 开发 |

### 1.3 目标用户

| 角色 | 使用场景 |
|------|----------|
| 产品经理 | 通过对话描述需求，Agent 生成可落地的 PRD |
| 开发工程师 | Agent 辅助编码、代码审查、自动化测试 |
| 项目管理者 | Agent 自动跟踪进度、分派任务、生成报告 |
| 设计师 | Agent 生成设计方案、UI 原型 |
| 运维工程师 | Agent 自动部署、监控告警 |

### 1.4 产品架构总览

```
┌─────────────────────────────────────────────────────────────────┐
│                        客户端层 (Client Tier)                     │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐       │
│  │ Web App  │  │ Desktop  │  │ 小程序    │  │ 消息渠道  │       │
│  │ Next.js  │  │ Electron │  │ UniApp   │  │ Multi-Ch │       │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘       │
└───────┼──────────────┼──────────────┼──────────────┼────────────┘
        │              │              │              │
┌───────┼──────────────┼──────────────┼──────────────┼────────────┐
│       ▼              ▼              ▼              ▼            │
│                   API Gateway (Golang)                          │
│              ┌──────────────────────────┐                      │
│              │   认证 / 限流 / 路由       │                      │
│              └────────────┬─────────────┘                      │
│                           │                                     │
│  ┌────────────────────────┼────────────────────────┐           │
│  │                 业务服务层 (Service Tier)          │           │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐      │           │
│  │  │ 用户服务  │  │ Agent 服务│  │ 渠道服务  │      │           │
│  │  │ (TS)     │  │ (TS/Py)  │  │ (TS)     │      │           │
│  │  └──────────┘  └──────────┘  └──────────┘      │           │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐      │           │
│  │  │ 插件服务  │  │ 记忆服务  │  │ 计费服务  │      │           │
│  │  │ (TS)     │  │ (Py)     │  │ (Go)     │      │           │
│  │  └──────────┘  └──────────┘  └──────────┘      │           │
│  └─────────────────────┬───────────────────────────┘           │
│                        │                                        │
│  ┌─────────────────────┼───────────────────────────┐           │
│  │              基础设施层 (Infra Tier)               │           │
│  │  ┌────────┐ ┌───────┐ ┌───────┐ ┌───────────┐  │           │
│  │  │Postgres│ │ Redis │ │MinIO  │ │  Milvus   │  │           │
│  │  └────────┘ └───────┘ └───────┘ └───────────┘  │           │
│  │  ┌────────────────┐  ┌────────────────────┐     │           │
│  │  │     Kafka      │  │     RabbitMQ       │     │           │
│  │  └────────────────┘  └────────────────────┘     │           │
│  └─────────────────────────────────────────────────┘           │
└─────────────────────────────────────────────────────────────────┘
```

### 1.5 技术选型

#### 1.5.1 前端技术栈

| 技术 | 用途 | 版本要求 |
|------|------|----------|
| React 19 | UI 框架 | ^19.0.0 |
| Next.js 15 | SSR/SSG 框架 | ^15.0.0 |
| HeroUI (NextUI v3) | 组件库 | ^3.0.0 |
| TailwindCSS 4 | 原子化 CSS | ^4.0.0 |
| Vercel AI SDK | AI 流式交互 | ^4.0.0 |

#### 1.5.2 桌面端

| 技术 | 用途 |
|------|------|
| Electron 33+ | 桌面应用框架 |
| electron-builder | 打包分发 |

#### 1.5.3 小程序

| 技术 | 用途 |
|------|------|
| UniApp (Vue 3) | 跨平台小程序 |
| uni-ui | 小程序组件库 |

#### 1.5.4 后端技术栈

| 技术 | 用途 | 语言 |
|------|------|------|
| API Gateway | 统一入口、认证、限流 | Golang |
| 用户/工作区服务 | 用户管理、团队、权限 | TypeScript (Node.js) |
| Agent 编排服务 | 多智能体调度、任务分派 | TypeScript + Python |
| 渠道服务 | 消息渠道接入 | TypeScript |
| 记忆/向量服务 | 向量检索、知识库 | Python |
| 计费服务 | 订阅、用量计费 | Golang |
| 插件服务 | 插件市场、安装管理 | TypeScript |

#### 1.5.5 数据存储

| 技术 | 用途 |
|------|------|
| PostgreSQL 16 | 主数据库（用户、配置、会话、计费） |
| Redis 7 | 缓存、会话状态、限流、发布/订阅 |
| MinIO | 文件存储（头像、附件、媒体、日志） |
| Milvus 2.4 | 向量数据库（记忆、知识库、语义搜索） |

#### 1.5.6 消息队列

| 技术 | 用途 |
|------|------|
| Kafka | Agent 事件流、日志聚合、高吞吐场景 |
| RabbitMQ | 任务分派、渠道消息路由、延迟队列 |

#### 1.5.7 AI Provider 集成

| 方案 | 用途 |
|------|------|
| OpenRouter | 统一模型路由 (多 Provider 聚合) |
| Vercel AI SDK | 前端 AI 流式交互 |
| LiteLLM | 后端统一模型调用接口 |

#### 1.5.8 Agentic 框架

| 方案 | 用途 |
|------|------|
| pi-mono (Pi Agent) | 核心 Agent 运行时 |
| pi-coder-review | 代码审查 Agent |
| Anthropic Agent Teams | 多 Agent 协作框架 |
| CrewAI / AutoGen | 备选多 Agent 编排 |

### 1.6 从 OpenClaw 到 SaaS 的核心改造点

| 维度 | OpenClaw (原始) | NextAI Agent (SaaS) |
|------|----------------|---------------------|
| 用户模型 | 单用户、本地运行 | 多租户、云端 SaaS |
| 数据存储 | 本地 JSON/SQLite | PostgreSQL + Redis + Milvus |
| 文件存储 | 本地文件系统 | MinIO 对象存储 |
| 部署 | 自部署 (npm/docker) | 云原生 K8s 部署 |
| 认证 | 本地 token/password | OAuth2 + JWT + RBAC |
| Agent | 单 Agent + 子 Agent | Multi-Agent Teams |
| 渠道 | 直连各渠道 SDK | 统一渠道网关 + 消息队列 |
| 计费 | 无 | 订阅 + 用量计费 |
| 前端 | Lit.js Web Components | React + Next.js + HeroUI |
| 桌面 | macOS 原生 Swift | Electron 跨平台 |
| 小程序 | 无 | UniApp 多端 |

### 1.7 产品版本规划

| 版本 | 功能范围 | 目标 |
|------|----------|------|
| MVP (v0.1) | 用户注册/登录 + 基础 Agent 对话 + WebChat | 验证核心交互 |
| v0.2 | 多 Agent 协作 + 工作区 + 渠道接入 | 验证协作流程 |
| v0.3 | 插件市场 + 记忆系统 + 计费 | 商业化准备 |
| v1.0 | 全功能 + 桌面 + 小程序 + 企业版 | 正式发布 |
